---
import Layout from '../layouts/Layout.astro';
import PetCard from '../components/pets/PetCard.astro';
import PetTabs from '../components/pets/PetTabs.astro';
import { getAllLatestPets } from '../lib/api/pets/queries';
import '../styles/layout/pets-grid.scss';

// limitを指定せずにすべてのペットを取得
const allPets = await getAllLatestPets();
// 初期表示もすべてのペットを表示
const initialPets = allPets;
const dogs = allPets.filter(pet => pet.animalType === 'dog');
const cats = allPets.filter(pet => pet.animalType === 'cat');
---

<Layout title="ペットを探す | すべて">
  <main>
    <section class="pets-section">
      <div class="container">
        <h1 class="pets-section__title">ペットを探す</h1>
        <PetTabs activeTab="all" />
        <div
          class="pets-grid"
          data-all-pets={JSON.stringify(initialPets)}
          data-dogs={JSON.stringify(dogs)}
          data-cats={JSON.stringify(cats)}
        >
          {initialPets.map((pet) => <PetCard pet={pet} />)}
        </div>
      </div>
    </section>
  </main>
</Layout>

<style lang="scss">
  @import '../styles/variables';
  @import '../styles/mixins';

  .pets-section {
    padding: $spacing-3xl 0;
    background-color: $color-background;
    min-height: calc(100vh - 300px);
  }

  .pets-section__title {
    font-size: 2.25rem;
    font-weight: $font-weight-bold;
    margin-bottom: $spacing-2xl;
    text-align: center;
  }
</style>